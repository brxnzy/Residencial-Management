<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link rel="stylesheet" href="{{url_for('static',filename='css/global.css')}}">
        <link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/daisyui@5.0.0-beta.2/daisyui.css" rel="stylesheet" type="text/css" />
        <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
        <script src="https://unpkg.com/alpinejs" defer></script>

        
    </head>
<body>

    <div class="flex px-4 items-center mt-2 justify-between mb-8">
        <h1
          class="text-4xl font-normal bold sm:text-2xl md:text-4xl lg:text-5xl text-left"
        >
          Usuarios
        </h1>
        <button
          class="px-2 py-2 bgverde text-white rounded-full"
          data-modal-target="authentication-modal"
          data-modal-toggle="authentication-modal"
        >
          <img src="{{ url_for('static', filename='icons/plus.svg')}}" class="h-9 w-9" />
        </button>
      </div>


      
<div
id="authentication-modal"
tabindex="-1"
aria-hidden="true"
class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"
>
<div class="relative p-6 w-full max-w-2xl max-h-full">
  <!-- Modal content -->
  <div class="relative bg-white rounded-lg shadow-sm dark:bg-gray-700">
    <!-- Modal header -->
    <div
      class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200"
    >
      <h3 class="text-2xl bold text-gray-900 dark:text-white">
        Formulario para Crear Usuario
      </h3>
      <button
        type="button"
        class="end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"
        data-modal-hide="authentication-modal"
      >
        <svg
          class="w-3 h-3"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 14 14"
        >
          <path
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
          />
        </svg>
        <span class="sr-only">Close modal</span>
      </button>
    </div>
    <!-- Modal body -->
    <div class="p-4 md:p-5">
      <form
        action="/admin/add_user"
        method="post"
        class="flex flex-wrap -mx-4"
      >
        <!-- <h1 class="text-3xl font-semib">Agregar Usuarios</h1> -->
        <!-- Campos de texto -->
        <div class="p-1 w-full">
          <div class="relative">
            <label
              for="id_card"
              class="leading-7 text-l bold text-gray-800"
              >Cédula:</label
            >
            <input
              type="text"
              autocomplete="off"
              min="13"
              max="13"
              placeholder="xxx-xxxxxxx-x"
              id="id_card"
              name="id_card"
              class="w-full bg-gray-100 bg-opacity-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 text-base outline-none text-gray-800 py-2 px-4 leading-8"
              required
            />
          </div>
        </div>
        <div class="p-1 w-full sm:w-1/2">
          <div class="relative">
            <label for="name" class="leading-7 text-l bold text-gray-800"
              >Nombre:</label
            >
            <input
              type="text"
              autocomplete="off"
              id="name"
              name="name"
              class="w-full bg-gray-100 bg-opacity-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 text-base outline-none text-gray-800 py-2 px-4 leading-8"
              required
            />
          </div>
        </div>

        <div class="p-1 w-full sm:w-1/2">
          <div class="relative">
            <label
              for="last_name"
              class="leading-7 text-l bold text-gray-800"
              >Apellido:</label
            >
            <input
              type="text"
              autocomplete="off"
              id="last_name"
              name="last_name"
              class="w-full bg-gray-100 bg-opacity-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 text-base outline-none text-gray-800 py-2 px-4 leading-8"
              required
            />
          </div>
        </div>

        <div class="p-1 w-full sm:w-1/2">
          <div class="relative">
            <label for="phone" class="leading-7 text-l bold text-gray-800"
              >Teléfono:</label
            >
            <input
              type="text"
              autocomplete="off"
              placeholder="123-4567-890"
              id="phone"
              name="phone"
              class="w-full bg-gray-100 bg-opacity-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 text-base outline-none text-gray-800 py-2 px-4 leading-8"
              required
            />
          </div>
        </div>

        <div class="p-1 w-full sm:w-1/2">
          <div class="relative">
            <label for="email" class="leading-7 text-l bold text-gray-800"
              >Email:</label
            >
            <input
              type="email"
              autocomplete="off"
              placeholder="varon@gmail.com"
              id="email"
              name="email"
              class="w-full bg-gray-100 bg-opacity-50 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 text-base outline-none text-gray-800 py-2 px-4 leading-8"
              required
            />
          </div>
        </div>

        <!-- Checkboxes en columna -->
        <div class="p-2 w-full flex flex-col gap-2">
          <div class="flex items-center">
            <input
              id="admin-checkbox"
              type="checkbox"
              name="is_admin"
              value="1"
              class="w-5 h-5 checkbox-option text-green-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-green-500 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
            />
            <label
              for="admin-checkbox"
              class="ml-2 text-l bold text-gray-900 dark:text-gray-300"
              >Admin</label
            >
          </div>
          <div class="flex items-center">
            <input
              id="resident-checkbox"
              type="checkbox"
              name="is_resident"
              value="1"
              class="checkbox-option w-5 h-5 text-green-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-green-500 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
            />
            <label
              for="resident-checkbox"
              class="ml-2 text-l bold text-gray-900 dark:text-gray-300"
              >Residente</label
            >
          </div>
          
          <div id="dropdownContainer" class="space-x-2 px-1.5 w-full my-3 hidden">
            <div class="flex w-full space-x-2">
              <!-- Primer Dropdown -->
              <select
                name="propertyType"
                id="propertyType"
                
                class="w-1/2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 appearance-none"
              >
                <option value="" disabled selected>Seleccione tipo de propiedad</option>
                <option value="casas">Casas</option>
                <option value="apartamentos">Apartamentos</option>
              </select>
          
              <!-- Segundo Dropdown -->
              <select
                name="propertyList"
              
                id="propertyList"
                class="w-1/2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 appearance-none hidden"
              >
                <option value="" disabled selected>Residencias Disponibles</option>
                {% for a in apartments %}
                {% if a.occupied == 0 %}
                  <option value="{{ a.id }}" class="apartamentos hidden">{{ a.building }}: {{ a.apartment_number }} </option>
                {% endif %}
              {% endfor %}
              
              {% for c in houses %}
                {% if c.occupied == 0 %}
                  <option value="{{ c.id }}" class="casas hidden">{{ c.address }}</option>
                {% endif %}
              {% endfor %}
              
              </select>
            </div>
          </div>
          


        
          

        <div class="py-2 w-full">
          <button
            type="submit"
            id="btn"
            disabled
            class="flex mx-auto cursor-not-allowed text-white bgverde border-0 px-6 py-3 focus:outline-none rounded-lg text-lg transition-all duration-300"
          >
            Agregar Usuario
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
</div>
<script>

  
  const checkbox = document.getElementById('resident-checkbox');
  const dropdownContainer = document.getElementById('dropdownContainer');
const propertyType = document.getElementById('propertyType');
const propertyList = document.getElementById('propertyList');

checkbox.addEventListener('change', function() {
  dropdownContainer.classList.toggle('hidden', !this.checked);
  if (!this.checked) {
    propertyType.value = '';
    propertyList.classList.add('hidden'); // Oculta el segundo select
    propertyList.value = '';
    toggleOptions('');
  }
});

propertyType.addEventListener('change', function() {
  propertyList.classList.remove('hidden'); // Muestra el segundo select directamente
  toggleOptions(this.value);
  propertyList.value = ''; // Resetea la selección del segundo dropdown
});

function toggleOptions(type) {
  const apartments = propertyList.querySelectorAll('.apartamentos');
  const houses = propertyList.querySelectorAll('.casas');

  apartments.forEach(option => option.classList.add('hidden'));
  houses.forEach(option => option.classList.add('hidden'));

  if (type === 'apartamentos') {
    apartments.forEach(option => option.classList.remove('hidden'));
  } else if (type === 'casas') {
    houses.forEach(option => option.classList.remove('hidden'));
  }
}
</script>
      
